<div class="container">
  <div class="flex-end-container">
    <app-button (click)="openModal()" (keydown)="onKeyDownButton($event)">Add Product</app-button>
  </div>
</div>

<app-modal [isVisible]="isModalVisible" (close)="closeModal()">
  <h2 class="mb-2rem">Create Product</h2>
  <form [formGroup]="createProductForm" (ngSubmit)="createProduct()" class="form">
    <div class="container-inputs">
      <app-input-with-error
        formControlName="productName"
        [errorMessage]="productNameError"
        [control]="productName"
        placeholder="Product Name"
      ></app-input-with-error>

      <app-text-area-with-error
        formControlName="productDescription"
        [errorMessage]="productDescriptionError"
        [control]="productDescription"
        placeholder="Product Description"
      ></app-text-area-with-error>

      <app-input-with-error
        formControlName="productQuantity"
        [errorMessage]="productQuantityError"
        [control]="productQuantity"
        placeholder="Product Quantity"
        type="number"
      ></app-input-with-error>

      <app-input-with-error
        formControlName="productPrice"
        [errorMessage]="productPriceError"
        [control]="productPrice"
        placeholder="Product Price"
        type="number"
      ></app-input-with-error>

      <app-dropdown-search-input
        formControlName="brandId"
        [items]="brands"
        [filteredItems]="filteredBrands"
        [selectedItems]="[selectedBrand]"
        [displayProperty]="'brandName'"
        [idProperty]="'brandId'"
        [maxSelection]="1"
        [placeholder]="'Search Brands'"
        (searchTermChange)="onSearchTermChange('brand', $event)"
        (filterItems)="filterBrands()"
        (selectItem)="selectBrand($event)"
      ></app-dropdown-search-input>

      <app-dropdown-search-input
        formControlName="categoryIds"
        [items]="categories"
        [filteredItems]="filteredCategories"
        [selectedItems]="selectedCategories"
        [displayProperty]="'categoryName'"
        [idProperty]="'categoryId'"
        [maxSelection]="3"
        [placeholder]="'Search Categories'"
        (searchTermChange)="onSearchTermChange('category', $event)"
        (filterItems)="filterCategories()"
        (selectItem)="selectCategory($event)"
        (removeItem)="removeCategory($event)"
      ></app-dropdown-search-input>
    </div>

    <div class="flex-center">
      <app-button [disabled]="createProductForm.invalid">Create Product</app-button>
    </div>
  </form>
</app-modal>